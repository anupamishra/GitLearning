Version 2 Utility function for version 1